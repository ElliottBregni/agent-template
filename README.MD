# Agent Config Template

Drop-in agent configuration for Claude Code, GitHub Copilot, Copilot CLI, and Claude Desktop.
Built for a senior staff SaaS engineering team. Uses Claude Opus 4.5 throughout.

## What's Included

```
â”œâ”€â”€ plugin.json                          # Copilot CLI plugin manifest (install with /plugin)
â”œâ”€â”€ AGENTS.MD                            # Shared agent instructions
â”œâ”€â”€ CLAUDE.md                            # Claude Code instructions
â”œâ”€â”€ .mcp.json                            # MCP catalog (~55 servers, all commented out)
â”‚
â”œâ”€â”€ .github/                             # â”€â”€ GitHub Copilot + Copilot CLI â”€â”€
â”‚   â”œâ”€â”€ copilot-instructions.md          # Global repo rules + agent directory
â”‚   â”œâ”€â”€ AGENTS.MD                        # Structure documentation
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                           # ðŸ†• Copilot CLI lifecycle hooks (GA Feb 2026)
â”‚   â”‚   â””â”€â”€ hooks.json                   # preToolUse safety gate + full audit logging
â”‚   â”‚
â”‚   â”œâ”€â”€ instructions/                    # Path-scoped rules (auto-applied by file pattern)
â”‚   â”‚   â”œâ”€â”€ tests.instructions.md        # *.test.*, *.spec.*, /tests/**
â”‚   â”‚   â”œâ”€â”€ api.instructions.md          # /api/**, /routes/**, /handlers/**
â”‚   â”‚   â”œâ”€â”€ migrations.instructions.md   # /migrations/**, *.migration.*
â”‚   â”‚   â”œâ”€â”€ security.instructions.md     # ** (global security rules)
â”‚   â”‚   â””â”€â”€ frontend.instructions.md     # /components/**, *.tsx, *.jsx, *.vue
â”‚   â”‚
â”‚   â”œâ”€â”€ prompts/                         # Slash commands (/command-name)
â”‚   â”‚   â”œâ”€â”€ review-pr.prompt.md          # /review-pr
â”‚   â”‚   â”œâ”€â”€ explain-code.prompt.md       # /explain-code
â”‚   â”‚   â”œâ”€â”€ security-review.prompt.md    # /security-review
â”‚   â”‚   â”œâ”€â”€ incident-postmortem.prompt.md # /incident-postmortem
â”‚   â”‚   â”œâ”€â”€ architecture-decision.prompt.md # /architecture-decision
â”‚   â”‚   â””â”€â”€ sprint-retro.prompt.md       # /sprint-retro
â”‚   â”‚
â”‚   â””â”€â”€ agents/                          # Agent orchestration
â”‚       â”œâ”€â”€ agent.yaml                   # Entrypoint: model, agents, skills, hooks, MCP
â”‚       â”œâ”€â”€ instructions.md              # Default agent system prompt
â”‚       â”‚
â”‚       â”œâ”€â”€ dev.agent.md                 # ðŸ†• General engineering (Claude Code behavior)
â”‚       â”œâ”€â”€ architect.agent.md           # ðŸ†• System design, ADRs (read-only)
â”‚       â”œâ”€â”€ security.agent.md            # ðŸ†• Security audits, OWASP (read-only)
â”‚       â”œâ”€â”€ oncall.agent.md              # ðŸ†• Incident response, postmortems
â”‚       â”œâ”€â”€ product.agent.md             # ðŸ†• Issue specs, backlog (read-only)
â”‚       â”œâ”€â”€ devops.agent.md              # ðŸ†• CI/CD, infra, observability
â”‚       â”‚
â”‚       â”œâ”€â”€ skills/                      # Reusable capabilities
â”‚       â”‚   â”œâ”€â”€ code-review.md
â”‚       â”‚   â”œâ”€â”€ test-generation.md
â”‚       â”‚   â”œâ”€â”€ docs-update.md
â”‚       â”‚   â”œâ”€â”€ issue-triage.md
â”‚       â”‚   â”œâ”€â”€ release-notes.md
â”‚       â”‚   â”œâ”€â”€ sprint-planning.md       # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ architecture-review.md   # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ api-design.md            # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ database-migrations.md   # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ security-audit.md        # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ dependency-audit.md      # ðŸ†•
â”‚       â”‚   â”œâ”€â”€ incident-response.md     # ðŸ†•
â”‚       â”‚   â””â”€â”€ performance-audit.md     # ðŸ†•
â”‚       â”‚
â”‚       â”œâ”€â”€ mcp/                         # MCP server layer
â”‚       â”‚   â”œâ”€â”€ servers.json             # Server definitions + auth
â”‚       â”‚   â”œâ”€â”€ tools.json               # Tool allow/deny + rate limits
â”‚       â”‚   â””â”€â”€ configs/                 # Per-server overrides
â”‚       â”‚
â”‚       â””â”€â”€ prompts/                     # Output templates
â”‚           â”œâ”€â”€ pr-description.md
â”‚           â”œâ”€â”€ commit-message.md
â”‚           â””â”€â”€ summary.md
â”‚
â”œâ”€â”€ .claude/                             # â”€â”€ Claude Code â”€â”€
â”‚   â”œâ”€â”€ settings.json
â”‚   â”œâ”€â”€ MEMORY.MD
â”‚   â”œâ”€â”€ skills/memory-collapse/
â”‚   â””â”€â”€ hooks/post-edit-lint.sh
â”‚
â”œâ”€â”€ .vscode/mcp.json                     # VS Code Copilot MCP servers
â”œâ”€â”€ .copilot/                            # Copilot CLI global config
â”œâ”€â”€ claude_desktop_config.json           # Claude Desktop MCP servers
â””â”€â”€ .gitignore.agent-additions
```

## Quick Start

1. **Use as template**: `Use this template` â†’ new repo, or copy into existing repo
2. **Replace placeholders** in:
   - `AGENTS.MD`, `CLAUDE.md`, `.github/copilot-instructions.md`, `.github/agents/instructions.md`
   - Search for `{{PROJECT_NAME}}`, `{{STACK}}`, `{{DEV_COMMAND}}`, etc.
3. **Enable MCP servers** you need â€” uncomment in `.mcp.json` and `.github/agents/mcp/servers.json`
4. **Add secrets** to `.github/agents/mcp/servers.json` (or use GitHub secrets via `${{ secrets.NAME }}`)
5. **Install as Copilot CLI plugin** (after pushing to GitHub):
   ```bash
   copilot plugin install your-org/your-repo
   ```
6. **Make hooks executable** (Claude Code):
   ```bash
   chmod +x .claude/hooks/*.sh
   ```

## Agents

Invoke with `@agent-name` in Copilot Chat or Copilot CLI:

| Agent | Model | Tools | Role |
|-------|-------|-------|------|
| `@dev` | Opus 4.5 | read, edit, search, run, create, delete | General engineering |
| `@architect` | Opus 4.5 | read, search, list | System design, ADRs |
| `@security` | Opus 4.5 | read, search, list | Security audits (read-only) |
| `@oncall` | Opus 4.5 | read, search, run | Incident response |
| `@product` | Opus 4.5 | read, search, list | Specs, backlog (read-only) |
| `@devops` | Opus 4.5 | read, edit, search, run, create | CI/CD, infra |

## Hooks (Copilot CLI GA â€” Feb 2026)

`hooks.json` enforces safety rules at the tool level â€” not just via instructions:

| Hook | What it does |
|------|-------------|
| `preToolUse` | Blocks: force-push to main, `git reset --hard`, `rm -rf` on non-build dirs, `DROP TABLE`, `--no-verify`, hardcoded secrets |
| `sessionStart/End` | Logs session with source/reason |
| `postToolUse` | Logs tool results |
| `errorOccurred` | Logs errors |

Audit log: `~/.copilot/audit.log`

## Slash Commands

| Command | Description |
|---------|-------------|
| `/review-pr` | Full quality, security, and correctness review |
| `/explain-code` | Plain language explanation of selected code |
| `/security-review` | OWASP-based security audit |
| `/incident-postmortem` | Blameless postmortem from incident details |
| `/architecture-decision` | Write a numbered ADR |
| `/sprint-retro` | Sprint retrospective from sprint data |

## Copilot CLI Commands (New in GA)

| Command | Description |
|---------|-------------|
| `Shift+Tab` | Plan mode â€” creates a plan before acting |
| `--autopilot` | Autonomous mode, no confirmation pauses |
| `& [task]` | Background delegation |
| `/diff` | Syntax-highlighted diff of changes |
| `/review` | Review staged changes |
| `/model` | Switch model mid-session |
| `Esc-Esc` | Rewind files to previous state |
| `copilot fleet` | Run multiple agents in parallel |

## Architecture Decisions

**Hooks over instructions** â€” Safety rules enforced at the tool layer. The model can't be talked out of a hook.

**Specialist agents with scoped tools** â€” `@security` has no write tools by design. `@product` can't edit files. Blast radius is limited to what each agent needs.

**Path-scoped instructions** â€” API security rules only load when editing API files. Migration rules only load for migration files. Reduces noise and context bloat.

**Skills vs prompts** â€” Skills define *how to do something* (behavioral). Prompts are slash commands that produce *output artifacts* (PR descriptions, ADRs, postmortems).

**MCP centralized in servers.json** â€” Rotate auth tokens in one place. Per-server overrides in `configs/` for scoped permissions.

## Tool Compatibility

| Config | Tool | MCP Format | Scope |
|--------|------|------------|-------|
| `.mcp.json` | Claude Code | `stdio` / `http` | Project |
| `.vscode/mcp.json` | VS Code Copilot | `command` / `http` | Project |
| `.github/hooks/hooks.json` | Copilot CLI | shell scripts | Repo (must be on default branch) |
| `.github/agents/*.agent.md` | Copilot CLI + VS Code | YAML frontmatter + markdown | Repo |
| `plugin.json` | Copilot CLI | plugin manifest | Installable package |
| `.github/agents/mcp/servers.json` | GitHub Coding Agent | `url` + secrets | Repo |
| `claude_desktop_config.json` | Claude Desktop | `command` only | Global |
